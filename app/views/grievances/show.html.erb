<!-- app/views/grievances/show.html.erb -->
<div class="whole-page grievance-show grievance-scope">
  <!-- Sent-on chip -->
  <% sender = @grievance.respond_to?(:user) && @grievance.user.present? ? @grievance.user : @user %>
  <div class="meta-chip">
    <div class="meta-chip__text">
      Sent on: <%= @grievance.created_at.strftime("%Y/%m/%d") %>
    </div>
    <%= image_tag(
        (sender&.username ? "#{sender.username}.png" : "default_avatar.png"),
        class: "meta-chip__avatar",
        alt: (sender&.username || "avatar")
      ) %>
  </div>
  <div class="banner banner--center">
    <h2>Grievance Drop</h2>
    <p>Share calmly. Reflect thoughtfully.</p>
  </div>
  <div class="card form-card">
    <!-- Topic -->
    <div class="form-group string required grievance_topic">
      <label class="form-label">Topic *</label>
      <div class="readonly-field"><%= @grievance.topic %></div>
    </div>
    <!-- Feelings -->
    <h2 class="section-title">How it made me feel...</h2>
    <div class="category-wrapper readonly-feelings">
      <% feelings = [["Tired","tired"], ["Sad","sad"], ["Upset","upset"], ["Anxious","anxious"]] %>
      <% feelings.each do |label, value| %>
        <% selected = @grievance.feeling.to_s.downcase == value %>
        <div class="category-item only-icon <%= selected ? 'category-item--selected' : 'category-item--dim' %>">
          <%= inline_svg_tag "icons/#{value}.svg", class: "mood-icon", aria: { hidden: true } %>
          <span class="visually-hidden"><%= label %></span>
        </div>
      <% end %>
    </div>
    <!-- Situation -->
    <div class="form-group text required grievance_situation">
      <label class="form-label">Description of the situation... *</label>
      <div class="readonly-field">
        <%= simple_format(@grievance.situation.presence || "â€”") %>
      </div>
    </div>
    <!-- Intensity (readonly slider) -->
    <div class="mb-3 intensity-block intensity-block--readonly">
      <label class="form-label" for="grievance_intensity_scale">Intensity Scale</label>
      <div class="intensity-scale">
        <div class="scale-icon scale-icon--min">
          <%= inline_svg_tag "icons/leaf.svg", class: "icon" %>
        </div>
        <div class="scale-slider">
          <input
            type="range"
            id="grievance_intensity_scale"
            class="intensity-slider"
            min="0" max="5" step="1"
            value="<%= @grievance.intensity_scale || 0 %>"
            disabled
          >
            <div class="scale-ticks" aria-hidden="true">
              <span></span><span></span><span></span><span></span><span></span><span></span>
            </div>
          </div>
          <div class="scale-icon scale-icon--max">
            <%= inline_svg_tag "icons/fire.svg", class: "icon" %>
          </div>
        </div>
      </div>
    </div>
    <div class="form-actions">
      <%= link_to "Back", grievances_path, class: "btn btn-coach w-100" %>
    </div>
  </div>
